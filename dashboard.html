<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard</title>
    <link rel="stylesheet" href="style.css?v=FINAL">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body id="page-dashboard">
    
    <div class="navbar">
        <img src="borsin.png" class="logo-circle">
        <div class="brand-text">
            <h2>SiBorsin</h2>
            <p>Manajemen Produksi</p>
        </div>
        <i class="fas fa-sign-out-alt nav-btn" id="btnLogout"></i>
    </div>

    <div class="container">
        <div class="admin-only" id="adm" style="display:none;">
            <h4 class="section-title">Menu Admin</h4>
            <div class="dashboard-grid">
                <a href="tambah_terjual.html" class="menu-item"><div class="icon-box trx-icon"><i class="fas fa-shopping-cart"></i></div><span>Jual</span></a>
                <a href="tambah_bukti.html" class="menu-item"><div class="icon-box adm-icon"><i class="fas fa-file-invoice-dollar"></i></div><span>Upload</span></a>
                <a href="tambah_data_ulos.html" class="menu-item"><div class="icon-box adm-icon"><i class="fas fa-upload"></i></div><span>Ulos</span></a>
                <a href="tambah_karyawan.html" class="menu-item"><div class="icon-box adm-icon"><i class="fas fa-user-plus"></i></div><span>Pegawai</span></a>
                <a href="tambah_pesanan.html" class="menu-item"><div class="icon-box adm-icon"><i class="fas fa-cart-plus"></i></div><span>Pesanan</span></a>
            </div>
        </div>

        <h4 class="section-title">Menu Utama</h4>
        <div class="dashboard-grid">
            <a href="chat.html" class="menu-item"><div class="icon-box inf-icon"><i class="fas fa-comments"></i></div><span>Diskusi</span></a> <a href="hitung_gaji.html" class="menu-item"><div class="icon-box inf-icon"><i class="fas fa-calculator"></i></div><span>Hitung</span></a>
            <a href="riwayat_terjual.html" class="menu-item"><div class="icon-box trx-icon"><i class="fas fa-history"></i></div><span>Riwayat</span></a>
            <a href="pesanan.html" class="menu-item"><div class="icon-box trx-icon"><i class="fas fa-clipboard-list"></i></div><span>Pesanan</span></a>
            <a href="ulos.html" class="menu-item"><div class="icon-box gld-icon"><i class="fas fa-images"></i></div><span>Galeri</span></a>
            <a href="data_karyawan.html" class="menu-item"><div class="icon-box gld-icon"><i class="fas fa-users"></i></div><span>Pegawai</span></a>
            <a href="rekapan_gaji.html" class="menu-item"><div class="icon-box inf-icon"><i class="fas fa-table"></i></div><span>Rekapan</span></a>
            <a href="slip_gaji.html" class="menu-item"><div class="icon-box inf-icon"><i class="fas fa-receipt"></i></div><span>Slip</span></a>
            <a href="bukti_pembayaran.html" class="menu-item"><div class="icon-box gld-icon"><i class="fas fa-receipt"></i></div><span>Bukti</span></a>
            <a href="tentang.html" class="menu-item"><div class="icon-box grey-icon"><i class="fas fa-info"></i></div><span>Tentang</span></a>
        </div>
    </div>

    <div class="bottom-nav">
        <a href="dashboard.html" class="nav-item active"><i class="fas fa-home"></i><span>Home</span></a>
        <a href="pesanan.html" class="nav-item"><i class="fas fa-clipboard-list"></i><span>Pesanan</span></a>
        <a href="data_karyawan.html" class="nav-item"><i class="fas fa-users"></i><span>Karyawan</span></a>
        <a href="slip_gaji.html" class="nav-item"><i class="fas fa-wallet"></i><span>Keuangan</span></a>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js";
        import { getAuth, signOut, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-auth.js";
        import { getFirestore, doc, getDoc } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore.js";

        const firebaseConfig = { apiKey: "AIzaSyAXM4yJgh9F7ajGQApB-Ux1itQ_3pkik_o", authDomain: "borsin-tenun-app.firebaseapp.com", projectId: "borsin-tenun-app", storageBucket: "borsin-tenun-app.firebasestorage.app", messagingSenderId: "718889934564", appId: "1:718889934564:web:c28a073e261d6783d096f1" };
        const app = initializeApp(firebaseConfig); const auth = getAuth(app); const db = getFirestore(app);

        onAuthStateChanged(auth, async u => {
            if(!u) window.location.href='login.html';
            else {
                try {
                    const d=await getDoc(doc(db,"users",u.uid));
                    if(d.exists()&&d.data().role==='admin') document.getElementById('adm').style.display='block';
                } catch(e){}
            }
        });
        document.getElementById('btnLogout').onclick=()=>signOut(auth);
    </script>
</body>
</html>
