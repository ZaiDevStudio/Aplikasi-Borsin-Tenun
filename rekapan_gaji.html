<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rekapan Gaji</title>
    <link rel="stylesheet" href="style.css?v=999">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <script src="https://cdn.sheetjs.com/xlsx-0.19.3/package/dist/xlsx.full.min.js"></script>
    
    <style>
        /* --- GAYA TABEL SUPER PADAT --- */
        
        /* 1. Ukuran Huruf Kecil */
        table { 
            border-collapse: collapse; 
            width: 100%; 
            font-size: 11px; /* Huruf diperkecil agar muat banyak */
            font-family: sans-serif;
        }
        
        /* 2. Sel Tabel Rapat */
        th, td { 
            border: 1px solid #ccc; 
            padding: 4px 2px; /* Jarak sangat rapat */
            white-space: nowrap; /* Teks satu baris */
            height: 30px; /* Tinggi baris dipangkas */
            vertical-align: middle;
        }

        /* HEADER MERAH */
        thead th { 
            background-color: #800000; 
            color: white; 
            position: sticky; 
            top: 0; 
            z-index: 20; 
            font-size: 10px; /* Judul lebih kecil */
            text-transform: uppercase;
        }

        /* --- STICKY COLUMN (KUNCI KOLOM KIRI) --- */
        
        /* Kolom 1: NO (Sangat Sempit) */
        th:nth-child(1), td:nth-child(1) {
            position: sticky; left: 0; z-index: 25;
            background-color: #fff; 
            width: 20px; min-width: 20px; 
            text-align: center;
            border-right: 1px solid #eee;
        }

        /* Kolom 2: NAMA (Lebih Pendek) */
        th:nth-child(2), td:nth-child(2) {
            position: sticky; left: 20px; z-index: 25;
            background-color: #fff; 
            width: 80px; min-width: 80px; max-width: 80px;
            overflow: hidden; text-overflow: ellipsis; /* Nama panjang jadi ... */
            border-right: 2px solid #800000; /* Batas Merah */
            font-weight: bold;
            color: #333;
        }
        
        /* Header Sticky agar tidak tertutup */
        thead th:nth-child(1) { background-color: #800000; z-index: 30; }
        thead th:nth-child(2) { background-color: #800000; z-index: 30; border-right: 2px solid white; }

        /* Footer Sticky */
        tfoot td { position: sticky; bottom: 0; background: #eee; font-weight: bold; z-index: 15; font-size: 10px; }
        tfoot td:nth-child(1) { position: sticky; left: 0; z-index: 30; border-right: none; }
        
        /* Warna Belang */
        tbody tr:nth-child(even) td { background-color: #f8f8f8; }
        /* Pastikan sticky tetap putih/belang saat digeser */
        tbody tr:nth-child(odd) td:nth-child(1), tbody tr:nth-child(odd) td:nth-child(2) { background-color: #fff; }
        tbody tr:nth-child(even) td:nth-child(1), tbody tr:nth-child(even) td:nth-child(2) { background-color: #f8f8f8; }

    </style>
</head>
<body id="page-rekapan-gaji">
    <div class="navbar">
        <a href="dashboard.html" class="nav-btn">⬅️</a>
        <h2 style="font-size:1rem;">Rekapan</h2> <i class="fas fa-file-excel nav-btn" onclick="exportExcel()" title="Unduh" style="cursor: pointer; margin-left: auto;"></i>
    </div>

    <div class="container" style="max-width:100%; padding: 5px;">
        <div class="card" style="padding:0; overflow-x: auto; max-height: 72vh; margin-bottom: 5px;">
            <table>
                <thead>
                    <tr>
                        <th>No</th>
                        <th>Nama</th>
                        <th>Ulos</th>
                        <th>Pakan</th>
                        <th>Pot. Lain</th>
                        <th>Bersih</th>
                        <th>Aksi</th>
                    </tr>
                </thead>
                <tbody id="tbodyGaji" style="text-align:center;">
                    <tr><td colspan="7">...</td></tr>
                </tbody>
                <tfoot>
                    <tr>
                        <td colspan="2" style="text-align:right; border-right: 2px solid #800000;">TOTAL:</td>
                        <td><span id="t_ulos">0</span></td>
                        <td style="color:red;" id="t_pakan">0</td>
                        <td>-</td>
                        <td style="color:green;" id="t_gaji">0</td>
                        <td></td>
                    </tr>
                </tfoot>
            </table>
        </div>

        <div class="card" style="background:#fff3e0; border:1px solid #ffcc80; padding: 10px;">
            <div style="display:flex; justify-content:space-between; font-size:0.8rem; border-bottom:1px dashed #ccc; padding-bottom:5px; margin-bottom:5px;">
                <span>Total Ulos:</span><strong id="info_ulos">0</strong>
            </div>
            <div style="display:flex; justify-content:space-between; font-size:0.8rem; border-bottom:1px dashed #ccc; padding-bottom:5px; margin-bottom:5px;">
                <span>Total Pakan:</span><strong id="info_pakan" style="color:red;">0</strong>
            </div>
            <div style="display:flex; justify-content:space-between; font-size:0.9rem;">
                <span>Total Gaji:</span><strong id="info_gaji" style="color:green;">0</strong>
            </div>
        </div>
    </div>
    
    <script>
        function exportExcel(){
            const t=document.querySelector("table");
            const w=XLSX.utils.table_to_book(t);
            XLSX.writeFile(w,"Rekapan_Gaji.xlsx");
        }
    </script>
    <script type="module" src="main.js?v=46"></script>
</body>
</html>
